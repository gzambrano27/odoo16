<?xml version="1.0"?>
<odoo>
    <data>


        <record id="document_financial_liquidation_view_tree"
                model="ir.ui.view">
            <field name="name">document.financial.liquidation.tree</field>
            <field name="model">document.financial.liquidation</field>
            <field name="type">tree</field>
            <field eval="1" name="priority"/>
            <field name="arch" type="xml">
                <tree string="Liquidación"
                    decoration-it="not invoice_fsv_id or not invoice_fbv_id"
                      decoration-bf="not invoice_fsv_id or not invoice_fbv_id"
                 decoration-danger="(invoice_fsv_id and invoice_fbv_id) and (total_invoiced!=total_payment) "
                decoration-success="(invoice_fsv_id and invoice_fbv_id) and (total_invoiced==total_payment) "
                >
 <field name="number_liquidation" />
<field name="date" />
                     <field name="current_nominal_value" />
                     <field name="original_nominal_value" />
                     <field name="effective_value" />
                     <field name="price_percentage" optional="hide" />
                     <field name="nominal_interest_rate" optional="hide" />
                    <field name="tir_tea" />
                    <field name="net_price_percentage" />
                    <field name="day_base" optional="hide" />
                    <field name="term_to_maturity" optional="hide"/>

                        <field name="type_emission" optional="hide"/>
                                 <field name="type_class"  optional="hide"/>

<field name="total_invoiced" sum="total" />
                    <field name="total_payment" sum="total" />

                    <field name="invoice_fsv_id" optional="hide" />
                    <field name="invoice_fbv_id" optional="hide"  />

                </tree>
            </field>
        </record>


        <record id="document_financial_liquidation_view_form"
                model="ir.ui.view">
            <field name="name">document.financial.liquidation.form</field>
            <field name="model">document.financial.liquidation</field>
            <field name="type">form</field>
            <field eval="1" name="priority"/>
            <field name="arch" type="xml">
                <form string="Liquidación" >
                    <header>



    <button name="%(document_financial_liq_version_wizard_view_action)d"
       type="action" icon="fa-upload"
string="Importar"
attrs="{'invisible':[('parent_state','!=','posted')]}"

       />

<button name="action_register_fsv_payment"
       type="object" icon="fa-money"
string="Pagar FSV"
attrs="{'invisible':['|',('parent_state','!=','posted'),('invoice_fsv_amount_residual','=',0.00)]}"

       />

                        <button name="action_register_fbv_payment"
       type="object" icon="fa-money"
                               string="Pagar FVB"

attrs="{'invisible':['|',('parent_state','!=','posted'),('invoice_fbv_amount_residual','=',0.00)]}"

       />
<field name="parent_state" invisible="1" />
                    </header>
                    <sheet>
                        <group>
                            <group>
<field name="company_id"  force_save="1" readonly="1" options="{'no_create':True,'no_edit':True,'no_open':True}"/>
                                <field name="id" string="# ID" readonly="1" attrs="{'invisible':[('id','&lt;=',0)]}"/>
 <field name="number_liquidation" />
                                <field name="emisor_id" required="1" options="{'no_create':True,'no_edit':True,'no_open':True}"/>
                <field name="currency_id"  invisible="1"  options="{'no_create':True,'no_edit':True,'no_open':True}"/>
 <field name="document_id"  invisible="1" options="{'no_create':True,'no_edit':True,'no_open':True}"/>
                                <field name="date_process" readonly="1" force_save="0" />
<field name="date" />
                                 <field name="sale_number" required="1" placeholder="ej. 1000-VRF45" />
                               <field name="day_base" required="1" placeholder="360/360" />

                                 <field name="term_to_maturity" required="1" placeholder="5a. 1800 d." />
                               <field name="issuance" invisible="1" placeholder="2"/>

                                  <field name="attachment_ids"
                                       widget="many2many_binary"/>

                            </group>
                            <group>
                                 <field name="type_emission" force_save="1" readonly="1"/>
                                 <field name="type_class"  force_save="1" readonly="1"/>
  <field name="current_nominal_value" required="1" />
                                <field name="original_nominal_value" required="1" />
                                  <field name="effective_value" required="1" />
                                <field name="price_percentage" required="1" />
                              <field name="nominal_interest_rate" required="1" />
                                 <field name="tir_tea" required="1" />
                                 <field name="net_price_percentage" required="1" />
<field name="price_net"  force_save="1" readonly="1"/>
                                 <field name="total_invoiced" readonly="1"/>
                                  <field name="total_payment" readonly="1"/>
                            </group>

                        </group>
                        <newline/>
                        <notebook>
                            <page string="Colocaciones">
                                <field nolabel="1" name="placement_ids" context="{'tree_view_ref':'gps_bancos.view_document_financial_placement_tree_liq','hide_liquidation':True,'hide_quota':True }" />
                            </page>
                             <page string="Facturas">
                                 <group>
                                     <group>
                                    <field  name="invoice_fsv_id"
                                            options="{'no_create':True,'no_edit':True,'no_open':True}"
                                      domain="[('company_id','=',company_id),('partner_id','=',emisor_id),('state','=','posted'),('move_type','in',('in_invoice','in_receipt')),('invoice_date','&gt;=',date_process)]"
                                      context="{'default_move_type': 'in_invoice','tree_view_ref':'account.view_in_invoice_bill_tree'}" />


               <field  name="invoice_fsv_invoice_date" readonly="1" force_save="0" />
                                                        <field  name="invoice_fsv_amount_total" readonly="1" force_save="0" />
                                         <field  name="reconciled_amount_fsv" readonly="1" force_save="0" />
<field name="invoice_fsv_amount_residual" readonly="1" force_save="0" />



                                                        <field  name="invoice_fsv_partner_id" readonly="1" force_save="0" />



                                 </group>
                                     <group>
                                      <field   name="invoice_fbv_id"
                                               options="{'no_create':True,'no_edit':True,'no_open':True}"

                                    context="{'default_move_type': 'in_invoice','tree_view_ref':'account.view_in_invoice_bill_tree'}"
                             domain="[('company_id','=',company_id),('partner_id.name','ilike','BOLSA DE VALORES'),('state','=','posted'),('move_type','in',('in_invoice','in_receipt')),('invoice_date','&gt;=',date_process)]"
                             />

                                               <field  name="invoice_fbv_invoice_date" readonly="1" force_save="0" />
                                                        <field  name="invoice_fbv_amount_total" readonly="1" force_save="0" />

                                          <field  name="reconciled_amount_fbv" readonly="1" force_save="0" />
<field name="invoice_fbv_amount_residual" readonly="1" force_save="0" />

                                                        <field  name="invoice_fbv_partner_id" readonly="1" force_save="0" />


                                 </group>

                                 </group>

                             </page>

                            <page string="Pagos">
                             <field nolabel="1" name="move_payment_ids" readonly="1"
                                    context="{'tree_view_ref':'account.view_move_tree'}"
                             />


                             </page>

                        </notebook>


                    </sheet>

                </form>
            </field>
        </record>



    </data>


</odoo>