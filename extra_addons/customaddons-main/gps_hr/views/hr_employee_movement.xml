<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="hr_employee_movement_view_search"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.search</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <search string="Movimientos">

                 <group expand="0" string="Filtrar...">
						<filter string="Preliminar" name="is_draft"
							domain="[('state','=','draft')]" />
                        <filter string="Aprobado" name="is_approved"
							domain="[('state','=','approved')]" />
                        <filter string="Anulado" name="is_cancelled"
							domain="[('state','=','cancelled')]" />
                        <filter string="Pagado" name="is_paid"
							domain="[('state','=','paid')]" />

					</group>
					<group expand="0" string="Agrupar por...">
						<filter string="Estados"
							context="{'group_by':'state'}" name='grp_state' />
						<filter string="Compañia"
							context="{'group_by':'company_id'}" name='grp_company_id' />
                        <filter string="Rubro"
							context="{'group_by':'rule_id'}" name='grp_rule_id' />
                        <filter string="Empleado" invisible="context.get('hide_employee_search',True)"
							context="{'group_by':'employee_id'}" name='grp_employee_id' />
                        <filter string="Fecha"
							context="{'group_by':'date_process'}" name='grp_date_process' />

					</group>

                <field name="id"/>
                <field name="company_id"/>
                <field name="rule_id"/>
                <field name="name"/>
                <field name="date_process"/>
            </search>
        </field>
    </record>


    <record id="hr_employee_movement_view_tree"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.tree</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                <field name="rule_id"/>
                <field name="name"/>
                 <field name="filter_iess" optional="hide"/>

                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>
                <field name="total" sum="total" attrs="{'invisible
':[('state','not in',('approved','paid'))]}"/>
                <field name="total_to_paid" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_paid" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_pending" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
             <field name="amount_to_pay" sum="total" invisible="not context.get('show2paid',False)" />
                <field name="state" optional="show" widget="badge"
                       decoration-muted="state=='cancelled'"
                       decoration-info="state=='draft'"
                       decoration-danger="state=='approved'"
                       decoration-success="state=='paid'"
                />
            </tree>
        </field>
    </record>


    <record id="hr_employee_movement_view_form"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.form</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <form string="Movimientos">

                 <header>
                    <button name="print_report" string="Imprimir" icon="fa-print"
                            type="object" attrs="{'invisible':[('state','=','cancelled')]}" />
                    <button
                            name="%(hr_employee_movement_wizard_view_compute_action)d"
                            string="Generar" type="action"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('locked_compute','=',True)]}"
                            icon="fa-list-ol"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />
                    <button
                            name="%(hr_employee_movement_wizard_view_file_action)d"
                            string="Importar" type="action"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('locked_import','=',True)]}"
                            icon="fa-upload"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />
                    <button
                            name="action_approved"
                            string="Aprobar" type="object"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('line_ids','=',[])]}"
                            icon="fa-check"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />
                    <button
                            name="action_draft"
                            string="Cambiar a Borrador" type="object"
                            attrs="{'invisible':['|',('state','in',('paid','cancelled','draft')),('total_paid','&gt;',0)]}"
                            icon="fa-rotate-left"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />

                    <button
                            name="action_create_payment_requests"
                            string="Enviar a Pagar" type="object"
                            groups="gps_hr.group_jefe_rrhh"
                    attrs="{'invisible':['|','|','|',('state','not in',('approved',)),('employee_payment_ids','!=',[]),('total_paid','!=',0.00),('payment','!=',True)]}"
                        icon="fa-money"/>

                    <button
                            name="action_cancelled"
                            string="Anular" type="object"
                            attrs="{'invisible':[('state','!=','draft')]}"
                            icon="fa-times" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>
                    <field name="state" widget="statusbar"/>
                </header>

                <sheet>

                <group>
                    <group>
                        <field name="id" string="# ID" attrs="{'invisible':[('id','&lt;=',0)]}"/>
                        <field name="company_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
   <field name="filter_iess" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="rule_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                               domain="[('legal_iess','=',filter_iess),('category_id','=',category_id),('type','=',type)]"
                        />
                        <field name="name" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <div colspan="2"
                             attrs="{'invisible':['|','|',('state','!=','draft'),('payment','!=',True),('account','!=',True)]}"
                             style="color:red">ESTE REGISTRO VALIDARA LA EXISTENCIA DE CUENTAS BANCARIAS POR CADA
                            EMPLEADO
                        </div>
                    </group>
                    <group>
                        <field name="date_process" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="total"/>
                        <field name="total_to_paid"/>
                        <field name="total_paid"/>
                        <field name="total_pending"/>
                        <field name="legal_iess" invisible="1"/>
                    </group>
                </group>
                <newline/>
                <notebook>
                    <page string="Detalle" name="page_detalle">
                         <group>
                            <button string="Borrar 0" colspan="1"
                                    name="delete_zeros" type="object"
                                    icon="fa-clear"
                                    attrs="{'invisible':[('state','!=','draft')]}"
                                    />
                        </group>
                        <newline/>
                        <field name="line_ids" attrs="{'readonly':[('state','!=','draft')]}"
                               context="{'tree_view_ref':'gps_hr.hr_employee_movement_line_view_tree_edit','form_view_ref':'gps_hr.hr_employee_movement_line_view_form',
                               'default_company_id':company_id,
                               'default_currency_id':currency_id,
                               'default_rule_id':rule_id,
                               'default_category_id':category_id,
                               'default_category_code':category_code,
                               'default_type':type,'default_date_process':date_process,'default_month_id':month_id,'default_year':year,
                               'default_locked_edit':locked_edit,
                               'default_legal_iess':legal_iess }"
                        />
                    </page>
 <page string="Solicitudes" name="page_employee_payments" attrs="{'invisible':[('employee_payment_ids','=',[])]}">
         <field name="employee_payment_ids" readonly="1">
             <tree string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>
                <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
            </tree>
             <form string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                 <group>
                       <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>

                 </group>
                  <group>
                                               <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
                 </group>


            </form>
         </field>
</page>
                    <page string="Otra Información" name="page_conf">
                        <group>
                            <group>
                                <field name="currency_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="month_id" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="year" readonly="1"/>


                                <field name="move_id" readonly="1"
                                       force_save="1" groups="gps_hr.group_contabilidad_rrhh"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True}"
                                       attrs="{'invisible':[('move_id','=',False)]}"
                                />


                            </group>
                            <group>
                                <field name="category_id" readonly="1" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="category_code" invisible="1"/>
                                <field name="type" readonly="1" force_save="1"/>
                                <field name="origin" readonly="1" force_save="1"/>
                                <field name="locked_import" invisible="1"/>
                                <field name="locked_compute" invisible="1"/>
                                <field name="locked_edit" invisible="1"/>
                                <field name="account" invisible="1"/>
                                <field name="payment" invisible="1"/>
                            </group>
                        </group>
                    </page>
                </notebook>
                <newline/>
                <field name="comments" placeholder="OBSERVACIONES..." attrs="{'readonly':[('state','!=','draft')]}"/>
                </sheet>
                 <newline/>

                <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user" options="{'post_refresh': 'recipients'}"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>

            </form>
        </field>
    </record>


    <!--  -->

    <record id="hr_employee_movement_view_out_action"
            model="ir.actions.act_window">
        <field name="name">Lotes de Egresos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">hr.employee.movement</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('category_code','=','OUT'),('type','in',('batch','batch_automatic'))]</field>
        <field name="context">{'search_default_is_draft':1,'search_default_is_approved':1,'search_default_is_paid':1,'default_type':'batch','default_category_code':'OUT'}</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="search_view_id"
               ref="hr_employee_movement_view_search"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_tree_out_action">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_out_action"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_form_out_action">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id"
               ref="hr_employee_movement_view_form"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_out_action"/>
    </record>

    <!--   -->

    <record id="hr_employee_movement_view_in_action"
            model="ir.actions.act_window">
        <field name="name">Lotes de Ingresos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">hr.employee.movement</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('category_code','=','IN'),('type','in',('batch','batch_automatic'))]</field>
        <field name="context">{'search_default_is_draft':1,'search_default_is_approved':1,'search_default_is_paid':1,'default_type':'batch','default_category_code':'IN'}</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="search_view_id"
               ref="hr_employee_movement_view_search"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_tree_in_action">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_in_action"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_form_in_action">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id"
               ref="hr_employee_movement_view_form"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_in_action"/>
    </record>

    <!--  -->

    <record id="hr_employee_movement_view_tree_discount"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.tree</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                <field name="rule_id"/>
                <field name="employee_id"/>
                <field name="name"/>
                  <field name="filter_iess" optional="hide"/>
                <field name="date_process"/>
                <field name="contract_id" optional="hide"/>
                <field name="currency_id" invisible="1"/>

                <field name="total" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_to_paid" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_paid" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_pending" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>

                <field name="state" optional="show" widget="badge"
                       decoration-muted="state=='cancelled'"
                       decoration-info="state=='draft'"
                       decoration-danger="state=='approved'"
                       decoration-success="state=='paid'"
                />
            </tree>
        </field>
    </record>


    <record id="hr_employee_movement_view_form_discount"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.form</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>

        <field name="arch" type="xml">
            <form string="Movimientos">
                <header>
                    <button name="print_report" string="Imprimir" icon="fa-print"
                            type="object" attrs="{'invisible':[('state','=','cancelled')]}" />
                    <button
                            name="%(hr_employee_movement_wizard_view_discount_compute_action)d"
                            string="Diferir" type="action"
                            attrs="{'invisible':['|',('rule_id','=',False),('state','!=','draft')]}"
                            icon="fa-list-ol"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />
                    <button
                            name="%(hr_employee_movement_import_wizard_view_discount_file_action)d"
                            string="Importar" type="action"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('locked_import','=',True)]}"
                            icon="fa-upload"

                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />

                    <button
                            name="action_approved"
                            string="Aprobar" type="object"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('line_ids','=',[])]}"
                            icon="fa-check"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />

                    <button
                            name="action_draft"
                            string="Cambiar a Borrador" type="object"
                            attrs="{'invisible':['|',('state','in',('paid','cancelled','draft')),('total_paid','&gt;',0)]}"
                            icon="fa-rotate-left"
                    groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"
                    />


                    <button
                            name="action_create_payment_requests"
                            string="Enviar a Pagar" type="object"
                            attrs="{'invisible':['|','|','|',('state','not in',('approved',)),('employee_payment_ids','!=',[]),('total_paid','!=',0.00),('payment','!=',True)]}"
                             icon="fa-money"

                    groups="gps_hr.group_jefe_rrhh"
                    />


                    <button
                            name="action_cancelled"
                            string="Anular" type="object"
                            attrs="{'invisible':['|',('state','!=','draft'),('total_paid','&gt;',0)]}"
                            icon="fa-times" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>

                    <field name="state" widget="statusbar"/>
                </header>
                 <sheet>
                <group>
                    <group>
                        <field name="id" string="# ID" attrs="{'invisible':[('id','&lt;=',0)]}"/>
                        <field name="company_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>

                     <field name="filter_iess" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="rule_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                               domain="[('legal_iess','=',filter_iess),('category_id','=',category_id),('type','=',type)]"
                        />
                        <field name="name" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <div colspan="2"
                             attrs="{'invisible':['|','|',('state','!=','draft'),('payment','!=',True),('account','!=',True)]}"
                             style="color:red">ESTE REGISTRO VALIDARA LA EXISTENCIA DE CUENTAS BANCARIAS POR CADA
                            EMPLEADO
                        </div>

                    </group>
                    <group>
                        <field name="employee_id" required="1" attrs="{'readonly':[('state','!=','draft')]}"
                               domain="[('company_id','=',company_id)]"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                       context="{'filter_date_process':date_process,'filter_rule_id':rule_id,'filter_company_id':company_id,'filter_legal_iess':legal_iess}"
                        />



                        <field name="contract_id" required="1" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                               domain="[('company_id','=',company_id),('employee_id','=',employee_id),('state','=','open')]"
                        />
                        <field name="date_process" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="total"/>
                        <field name="total_to_paid" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                        <field name="total_paid" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                        <field name="total_pending" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                        <field name="legal_iess" invisible="1"/>
                    </group>
                </group>
                <newline/>
                <notebook>
                    <page string="Detalle" name="page_detalle">
                         <group>
                            <button string="Borrar 0" colspan="1"
                                    name="delete_zeros" type="object"
                                    icon="fa-clear"
                                    attrs="{'invisible':[('state','!=','draft')]}"
                                    />
                        </group>
                        <newline/>
                        <field name="line_ids" attrs="{'readonly':[('state','!=','draft')]}"
                               context="{'tree_view_ref':'gps_hr.hr_employee_movement_line_view_tree_discount_edit','form_view_ref':'gps_hr.hr_employee_movement_line_view_form',
                               'default_company_id':company_id,
                               'default_currency_id':currency_id,
                               'default_rule_id':rule_id,
                               'default_category_id':category_id,
                               'default_category_code':category_code,
                               'default_type':type,'default_date_process':date_process,'default_month_id':month_id,'default_year':year,
                               'default_employee_id':employee_id,'default_contract_id':contract_id,'default_job_id':job_id,'default_department_id':department_id,
                               'default_locked_edit':locked_edit,
                               'default_legal_iess':legal_iess
                               }"
                        />
                    </page>
                    <page string="Solicitudes" name="page_employee_payments" attrs="{'invisible':[('employee_payment_ids','=',[])]}">
         <field name="employee_payment_ids" readonly="1">
            <tree string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>
                <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
            </tree>
             <form string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                 <group>
                       <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>

                 </group>
                  <group>
                                               <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
                 </group>


            </form>
         </field>
</page>
                    <page string="Otra Información" name="page_conf">
                        <group>
                            <group>
                                <field name="currency_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="month_id" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="year" readonly="1"/>
                                <field name="job_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                                       readonly="1" force_save="1"
                                />
                                <field name="department_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                                       readonly="1" force_save="1"
                                />
                                <field name="move_id" readonly="1"
                                       force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True}"
                                       attrs="{'invisible':[('move_id','=',False)]}"
                                />
                                <field name="bank_account_id" readonly="1"
                                       force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True}"
attrs="{'invisible':[('bank_account_id','=',False)]}"
                                />

<field name="bank_history_id" readonly="1"
                                       force_save="1"
                                       options="{'no_open': True,'no_quick_create': True,'no_create': True,'no_create_edit': True}"
attrs="{'invisible':[('bank_account_id','=',False)]}"
                                />

                                <field name="bank_acc_number" readonly="1"
                                       force_save="1"
attrs="{'invisible':[('bank_account_id','=',False)]}"
                                />

                                <field name="bank_tipo_cuenta" readonly="1"
                                       force_save="1"
attrs="{'invisible':[('bank_account_id','=',False)]}"
                                />

                            </group>
                            <group>
                                <field name="category_id" readonly="1" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="category_code" invisible="1"/>
                                <field name="type" readonly="1" force_save="1"/>
                                <field name="origin" readonly="1" force_save="1"/>
                                <field name="locked_import" invisible="1"/>
                                <field name="locked_compute" invisible="1"/>
                                <field name="locked_edit" invisible="1"/>
                                <field name="account" invisible="1"/>
                                <field name="payment" invisible="1"/>
                                <field name="pay_with_transfer"
                                      attrs="{'readonly':[('state','!=','draft')]}"
                                />
                                  <field name="employee_payment_id" readonly="1" context="{'form_view_ref':'gps_hr.hr_employee_payment_view_form'}"
                                  attrs="{'invisible':[('employee_payment_id','=',False)]}"

                                  />
                            </group>
                        </group>
                    </page>
                </notebook>
                <newline/>
                <field name="comments" placeholder="OBSERVACIONES..." attrs="{'readonly':[('state','!=','draft')]}"/>
                 </sheet>

                 <newline/>

                <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user" options="{'post_refresh': 'recipients'}"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>

            </form>
        </field>
    </record>


    <!--  -->

    <record id="hr_employee_movement_view_discount_action"
            model="ir.actions.act_window">
        <field name="name">Préstamos y Anticipos</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">hr.employee.movement</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('category_code','=','OUT'),('type','=','discount')]</field>
        <field name="context">{'search_default_is_draft':1,'search_default_is_approved':1,'search_default_is_paid':1,'hide_employee_search':False,'default_type':'discount','default_category_code':'OUT'}</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree_discount"/>
        <field name="search_view_id"
               ref="hr_employee_movement_view_search"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_tree_discount_action">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree_discount"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_discount_action"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_form_discount_action">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id"
               ref="hr_employee_movement_view_form_discount"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_discount_action"/>
    </record>


    <!--  -->

     <record id="hr_employee_movement_view_tree_readonly"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.tree.readonly</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="9" name="priority"/>
        <field name="arch" type="xml">
            <tree string="Movimientos">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                <field name="rule_id"/>
                <field name="employee_id"/>
                <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>
                <field name="total" sum="total" attrs="{'invisible
':[('state','not in',('approved','paid'))]}"/>
                <field name="total_to_paid" optional="hide" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_paid" optional="hide" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="total_pending" optional="hide" sum="total" attrs="{'invisible':[('state','not in',('approved','paid'))]}"/>
                <field name="amount_to_pay" sum="total" invisible="not context.get('show2paid',False)" />



                <field name="state" optional="show" widget="badge"
                       decoration-muted="state=='cancelled'"
                       decoration-info="state=='draft'"
                       decoration-danger="state=='approved'"
                       decoration-success="state=='paid'"
                />
            </tree>
        </field>
    </record>

    <record id="hr_employee_movement_view_form_readonly"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.form.readonly</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="9999   " name="priority"/>
        <field name="arch" type="xml">
            <form string="Movimientos">
                <header>
                    <button name="print_report" string="Imprimir" icon="fa-print"
                            type="object" attrs="{'invisible':[('state','=','cancelled')]}" />

                    <field name="state" widget="statusbar"/>
                </header>
                <group>
                    <group>
                        <field name="id" string="# ID" attrs="{'invisible':[('id','&lt;=',0)]}"/>
                        <field name="company_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>

                       <field name="filter_iess" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="rule_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                               domain="[('legal_iess','=',filter_iess),('category_id','=',category_id),('type','=',type)]"
                        />
                        <field name="name" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <div colspan="2"
                             attrs="{'invisible':['|','|',('state','!=','draft'),('payment','!=',True),('account','!=',True)]}"
                             style="color:red">ESTE REGISTRO VALIDARA LA EXISTENCIA DE CUENTAS BANCARIAS POR CADA
                            EMPLEADO
                        </div>
                    </group>
                    <group>
                        <field name="employee_id" readonly="1"
                             attrs="{'invisible':[('employee_id','=',False)]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>



                        <field name="date_process" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="total"/>
                        <field name="total_to_paid"/>
                        <field name="total_paid"/>
                        <field name="total_pending"/>
                        <field name="legal_iess" invisible="1"/>
                    </group>
                </group>
                <newline/>
                <notebook>
                    <page string="Detalle" name="page_detalle" >
                        <field name="line_ids" attrs="{'readonly':[('state','!=','draft')]}" >
                            <tree string="Detalle">
                                <field name="employee_id" />

                                <field name="quota" />
                                <field name="date_process" />
                                <field name="total" />
                                <field name="comments" />

                            </tree>
                        </field>
                    </page>  <page string="Otra Información" name="page_conf">
                        <group>
                            <group>
                                <field name="currency_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="month_id" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="year" readonly="1"/>


                                <field name="move_id" readonly="1"
                                       force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True}"
                                       attrs="{'invisible':[('move_id','=',False)]}"
                                />


                            </group>
                            <group>
                                <field name="category_id" readonly="1" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="category_code" invisible="1"/>
                                <field name="type" readonly="1" force_save="1"/>
                                <field name="origin" readonly="1" force_save="1"/>
                                <field name="locked_import" invisible="1"/>
                                <field name="locked_compute" invisible="1"/>
                                <field name="locked_edit" invisible="1"/>
                                <field name="account" invisible="1"/>
                                <field name="payment" invisible="1"/>
                            </group>
                        </group>
                    </page>
                </notebook>
                <newline/>
                <field name="comments" placeholder="OBSERVACIONES..." attrs="{'readonly':[('state','!=','draft')]}"/>
            </form>
        </field>
    </record>


        <record id="hr_employee_movement_view_form_provision"
            model="ir.ui.view">
        <field name="name">hr.employee.movement.form.provision</field>
        <field name="model">hr.employee.movement</field>
        <field name="type">tree</field>
        <field eval="8" name="priority"/>
        <field name="arch" type="xml">
            <form string="Movimientos">
                <header>
                    <button name="print_report" string="Imprimir" icon="fa-print"
                            type="object" attrs="{'invisible':[('state','=','cancelled')]}" />
                    <button
                            name="%(hr_employee_movement_wizard_view_compute_action)d"
                            string="Generar" type="action"
                            attrs="{'invisible':['|',('rule_id','=',False),('state','!=','draft')]}"
                            icon="fa-list-ol" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>
                    <button
                            name="action_approved"
                            string="Aprobar" type="object"
                            attrs="{'invisible':['|','|',('rule_id','=',False),('state','!=','draft'),('line_ids','=',[])]}"
                            icon="fa-check" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>
                    <button
                            name="action_draft"
                            string="Cambiar a Borrador" type="object"
                            attrs="{'invisible':['|',('state','in',('paid','cancelled','draft')),('total_paid','&gt;',0)]}"
                            icon="fa-rotate-left" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>

                       <button
                            name="action_create_payment_requests"
                            string="Enviar a Pagar" type="object"
                            attrs="{'invisible':['|','|',('state','not in',('approved',)),('employee_payment_ids','!=',[]),('total_paid','!=',0.00)]}"
                             icon="fa-money"

                    groups="gps_hr.group_jefe_rrhh"
                    />

                    <button
                            name="action_cancelled"
                            string="Anular" type="object"
                            attrs="{'invisible':[('state','!=','draft')]}"
                            icon="fa-times" groups="gps_hr.group_asistente_rrhh,gps_hr.group_jefe_rrhh"/>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                <group>
                    <group>
                        <field name="id" string="# ID" attrs="{'invisible':[('id','&lt;=',0)]}"/>
                        <field name="company_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
   <field name="filter_iess" attrs="{'readonly':[('state','!=','draft')]}" invisible="1"/>
                        <field name="rule_id" attrs="{'readonly':[('state','!=','draft')]}"
                               options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"
                               domain="[('legal_iess','=',filter_iess),('category_id','=',category_id),('for_liquidate_provision','=',True),('enable_for_documents','=',True)]"
                        />
                        <field name="name" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <div colspan="2"
                             attrs="{'invisible':['|','|',('state','!=','draft'),('payment','!=',True),('account','!=',True)]}"
                             style="color:red">ESTE REGISTRO VALIDARA LA EXISTENCIA DE CUENTAS BANCARIAS POR CADA
                            EMPLEADO
                        </div>
                    </group>
                    <group>
                        <field name="date_process" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="total"/>
                        <field name="total_to_paid"/>
                        <field name="total_paid"/>
                        <field name="total_pending"/>
                        <field name="legal_iess" invisible="1"/>
                    </group>
                </group>
                <newline/>
                <notebook>
                    <page string="Detalle" name="page_detalle">
                        <group>
                            <button string="Borrar 0" colspan="1"
                                    name="delete_zeros" type="object"
                                    icon="fa-clear"
                                    attrs="{'invisible':[('state','!=','draft')]}"
                                    />
                        </group>
                        <newline/>
                        <field name="line_ids" attrs="{'readonly':[('state','!=','draft')]}"
                               context="{'tree_view_ref':'gps_hr.hr_employee_movement_line_view_tree_edit_provision','form_view_ref':'gps_hr.hr_employee_movement_line_view_form',
                               'default_company_id':company_id,
                               'default_currency_id':currency_id,
                               'default_rule_id':rule_id,
                               'default_category_id':category_id,
                               'default_category_code':category_code,
                               'default_type':type,'default_date_process':date_process,'default_month_id':month_id,'default_year':year,
                               'default_locked_edit':locked_edit,
                               'default_legal_iess':legal_iess }"
                        />
                    </page>
                   <page string="Solicitudes" name="page_employee_payments" attrs="{'invisible':[('employee_payment_ids','=',[])]}">
         <field name="employee_payment_ids" readonly="1">
             <tree string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>
                <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
            </tree>
             <form string="Pagos de Nómina" editable="bottom" create="false" delete="false" edit="false">
                 <group>
                       <field name="id" string="# ID" optional="hide"/>
                <field name="company_id"/>
                  <field name="name"/>
                <field name="date_process"/>
                <field name="currency_id" invisible="1"/>

                 </group>
                  <group>
                                               <field name="total" sum="total"/>
                  <field name="ref"/>
                  <field name="state" optional="show" widget="badge" decoration-muted="state=='cancelled'" decoration-warning="state=='sended'" decoration-info="state=='draft'" decoration-success="state=='approved'"/>
                 </group>


            </form>
         </field>
</page>
                    <page string="Otra Información" name="page_conf">
                        <group>
                            <group>
                                <field name="currency_id"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="month_id" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="year" readonly="1"/>


                                <field name="move_id" readonly="1"
                                       force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True}"
                                       attrs="{'invisible':[('move_id','=',False)]}"
                                />


                            </group>
                            <group>
                                <field name="category_id" readonly="1" force_save="1"
                                       options="{'no_quick_create': True,'no_create': True,'no_create_edit': True,'no_open':True}"/>
                                <field name="category_code" invisible="1"/>
                                <field name="type" readonly="1" force_save="1"/>
                                <field name="origin" readonly="1" force_save="1"/>
                                <field name="locked_import" invisible="1"/>
                                <field name="locked_compute" invisible="1"/>
                                <field name="locked_edit" invisible="1"/>
                                <field name="account" invisible="1"/>
                                <field name="payment" invisible="1"/>
                            </group>
                        </group>
                    </page>
                </notebook>

                      <newline/>
                <field name="comments" placeholder="OBSERVACIONES..." attrs="{'readonly':[('state','!=','draft')]}"/>



                </sheet>

                <newline/>

                <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user" options="{'post_refresh': 'recipients'}"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>

            </form>
        </field>
    </record>


    <record id="hr_employee_movement_view_provision_action"
            model="ir.actions.act_window">
        <field name="name">Pagos de Provisiones</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">hr.employee.movement</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('category_code','=','IN'),('type','=','batch'),('rule_id.enable_for_documents','=',True),('rule_id.for_liquidate_provision','=',True)]</field>
        <field name="context">{'search_default_is_draft':1,'search_default_is_approved':1,'search_default_is_paid':1,'hide_employee_search':False,'default_type':'batch','default_category_code':'IN'}</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="search_view_id"
               ref="hr_employee_movement_view_search"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_tree_provision_action">
        <field name="sequence" eval="1"/>
        <field name="view_mode">tree</field>
        <field name="view_id"
               ref="hr_employee_movement_view_tree"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_provision_action"/>
    </record>

    <record model="ir.actions.act_window.view"
            id="hr_employee_movement_view_form_provision_action">
        <field name="sequence" eval="2"/>
        <field name="view_mode">form</field>
        <field name="view_id"
               ref="hr_employee_movement_view_form_provision"/>
        <field name="act_window_id"
               ref="hr_employee_movement_view_provision_action"/>
    </record>

</odoo>
